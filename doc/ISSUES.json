{
  "issues": [
    {
      "id": "CHANGE-250627-001",
      "type": "change",
      "epic": "Notifications",
      "title": "Implement Vuex store for notification state management",
      "description": "Current notification handling uses direct IPC communication and event-based updates. While it supports simple notification functionality, it would benefit from a centralized Vuex store for more complex notification state management, consistency, and easier state access across components.",
      "acceptance_criteria": [
        "Create a Vuex store module for notifications (store/modules/notifications.js)",
        "Move notification state management from event-based to store-based approach",
        "Ensure all notification components use the store instead of direct IPC events",
        "Maintain existing notification functionality during transition",
        "Add tests for notification store mutations and actions"
      ],
      "passes": true
    },
    {
      "id": "TASK-250627-002",
      "type": "task",
      "epic": "IPC Architecture",
      "title": "Consolidate and clarify IPC communication patterns",
      "description": "The preload script exposes two communication objects: 'api' (generic send/receive with whitelisted channels) and 'electron' (large number of direct invokers and specific event listeners). The 'electron' object is the predominant pattern, while 'api' appears underutilized or from an older pattern. This creates confusion about which pattern to use.",
      "acceptance_criteria": [
        "Audit all IPC communication patterns in the codebase",
        "Decide on a single, consistent IPC pattern for the application",
        "Document the chosen pattern in AGENTS.md or developer documentation",
        "Refactor code to use the consistent pattern throughout",
        "Remove or update the unused pattern documentation"
      ],
      "passes": true,
      "resolution": "Removed unused 'api' object, extracted VALID_IPC_CHANNELS constant, confirmed window.electron.* pattern is documented in AGENTS.md"
    },
    {
      "id": "STORY-250627-003",
      "type": "story",
      "epic": "Notifications",
      "title": "Detect system notification permissions status",
      "description": "Users need to enable system notifications manually in OS settings (e.g., macOS System Settings). The app should detect if notifications are enabled and provide in-app guidance to users when notifications are disabled.",
      "acceptance_criteria": [
        "Implement API to check system notification permission status",
        "Display user-friendly message in settings when notifications are disabled",
        "Provide direct link/button to open system notification settings",
        "Support macOS, Windows, and Linux platforms",
        "Add documentation for notification permission requirements"
      ],
      "passes": false
    },
    {
      "id": "STORY-250627-004",
      "type": "story",
      "epic": "Task Management",
      "title": "Implement task dependency selection UI",
      "description": "When creating or editing a task, users should be able to select dependencies from a dropdown with checkboxes. Selected dependencies become prerequisites that must be completed before the task can be started.",
      "acceptance_criteria": [
        "Add dependency selector component to task creation/edit form",
        "Display available tasks as checkboxes in searchable dropdown",
        "Show dependency relationships visually (e.g., task ordering indicators)",
        "Prevent circular dependencies in validation logic",
        "Auto-order tasks based on dependency completion status",
        "Update task list to show dependency relationships"
      ],
      "passes": false
    },
    {
      "id": "BUG-250627-007",
      "type": "bug",
      "epic": "Notifications",
      "title": "Handle notification scheduling edge cases",
      "description": "The notification scheduling mechanism needs to handle edge cases gracefully: system clock changes (backward/forward), app restarts/crashes, and system sleep/wake cycles.",
      "acceptance_criteria": [
        "Implement clock change detection and notification rescheduling",
        "Persist scheduled notifications and restore on app startup",
        "Handle system sleep/wake events for pending notifications",
        "Add tests for edge case scenarios",
        "Log notification scheduling events for debugging"
      ],
      "passes": true,
      "resolution": "Added database sent_at tracking column, powerMonitor for sleep/wake, periodic clock monitoring, idempotent notification sending, and comprehensive edge case tests."
    },
    {
      "id": "TASK-250627-008",
      "type": "task",
      "epic": "Projects",
      "title": "Improve error handling in project service",
      "description": "The project service (app/src/services/project.js) needs more specific error handling for database operations to provide better debugging information and user feedback.",
      "acceptance_criteria": [
        "Add try-catch blocks for all database operations",
        "Provide specific error messages for different failure types",
        "Log errors with sufficient context for debugging",
        "Return user-friendly error messages to the UI",
        "Add error handling tests"
      ],
      "passes": true
    },
    {
      "id": "TASK-250627-009",
      "type": "task",
      "epic": "Tasks",
      "title": "Improve data validation in task service",
      "description": "The task service (app/src/services/task.js) needs improved data validation, especially for date and time formats, to prevent invalid data from being stored in the database.",
      "acceptance_criteria": [
        "Add validation for all task properties (dates, times, priorities, duration, labels, dependencies)",
        "Validate ISO 8601 format for plannedTime before storage (reject invalid Date objects)",
        "Validate YYYY-MM-DD format for dueDate before storage (reject malformed dates)",
        "Validate date ranges (due_date must be after created_at)",
        "Validate duration is positive (> 0)",
        "Use a consistent date/time format throughout the application",
        "Add validation tests for task creation and updates",
        "Document validation rules in developer documentation",
        "Document timezone assumptions and expected date/time input formats (see doc/DATE_TIME_FORMATS.md)",
        "Reject invalid Date objects instead of storing 'Invalid Date' string"
      ],
      "passes": false
    },
    {
      "id": "BUG-250627-010",
      "type": "bug",
      "epic": "Tasks",
      "title": "Prevent circular dependencies in task and notification services",
      "description": "There's a potential for circular dependencies between task.js and notification.js when deleting tasks and associated notifications. This needs to be resolved to prevent runtime errors.",
      "acceptance_criteria": [
        "Analyze and document the dependency chain between services",
        "Refactor to eliminate circular dependencies",
        "Ensure task deletion properly cleans up notifications without circular calls",
        "Add tests to prevent regression of circular dependencies",
        "Document the proper pattern for cross-service operations"
      ],
      "passes": false
    },
    {
      "id": "TASK-250627-011",
      "type": "task",
      "epic": "Architecture",
      "title": "Separate main process and renderer process concerns",
      "description": "The main process (app/electron.js) and IPC handlers import modules under app/src/services/*, blurring the boundary between main and renderer concerns. This complicates bundling/testing, especially where renderer-only utilities (e.g., window.logger) are referenced.",
      "acceptance_criteria": [
        "Audit all imports from app/src/services/* in main process files",
        "Move shared business logic to a location accessible by both processes",
        "Create main-specific service layer for IPC handlers",
        "Ensure renderer-only utilities are not referenced in main process",
        "Add tests for main process service layer",
        "Update AGENTS.md with clear separation guidance"
      ],
      "passes": false
    },
    {
      "id": "TASK-250627-015",
      "type": "task",
      "epic": "Architecture",
      "title": "Refactor monolithic functionHandlers.js module",
      "description": "app/electron-main/functionHandlers.js is a monolith with multiple responsibilities (validation/parsing/filtering/formatting/tool dispatch). This will become harder to safely extend as more AI functions are added.",
      "acceptance_criteria": [
        "Analyze current responsibilities in functionHandlers.js",
        "Separate validation logic into dedicated module",
        "Separate parsing logic into dedicated module",
        "Separate filtering/formatting logic into utilities",
        "Keep only tool dispatch orchestration in functionHandlers",
        "Add tests for each extracted module",
        "Update AGENTS.md with new structure"
      ],
      "passes": false
    },
    {
      "id": "TASK-250627-018",
      "type": "task",
      "epic": "Code Quality",
      "title": "Extend lint coverage to test files",
      "description": "ISSUE RESOLVED: Investigation confirmed test files ARE being linted. eslint.config.js never ignored **/*.test.js - they have explicit configuration with Vitest globals and relaxed complexity rules. All 15 test files pass linting.",
      "acceptance_criteria": [
        "Remove or adjust **/*.test.js exclusion from eslint.config.js",
        "Run ESLint on test files and fix existing issues",
        "Add test-specific lint rules if needed (e.g., for test globals)",
        "Ensure npm run lint checks all JavaScript files",
        "Add lint test to CI pipeline"
      ],
      "passes": true,
      "resolution": "All criteria met: test files have explicit ESLint config with Vitest globals, no exclusion exists, and npm run lint checks all files including tests."
    },
    {
      "id": "STORY-250627-019",
      "type": "story",
      "epic": "Testing",
      "title": "Implement end-to-end tests for IPC communication boundaries",
      "description": "No end-to-end tests across preload <-> IPC <-> main <-> renderer boundaries. This critical communication path lacks integration testing, increasing risk of regressions in inter-process communication.",
      "acceptance_criteria": [
        "Research E2E testing approach for Electron (e.g., Spectron, Playwright)",
        "Create test infrastructure for spawning Electron app in test environment",
        "Write tests for preload script API exposure",
        "Write tests for IPC request/response flow (renderer -> main -> renderer)",
        "Write tests for IPC event flow (main -> renderer)",
        "Test error handling across process boundaries",
        "Add E2E tests to CI pipeline"
      ],
      "passes": false
    },
    {
      "id": "TASK-260105-021",
      "type": "task",
      "epic": "IPC Architecture",
      "title": "Refactor oversized IPC handler setup to reduce function length",
      "description": "setupIpcHandlers in app/electron-main/ipcHandlers.js exceeds the max-lines-per-function threshold, making the file harder to maintain and review.",
      "acceptance_criteria": [
        "Split setupIpcHandlers into smaller, focused helpers",
        "Preserve existing IPC behavior and handler registrations",
        "Keep file-level documentation up to date after refactor",
        "Resolve the max-lines-per-function lint warning"
      ],
      "passes": false
    },
    {
      "id": "TASK-260105-022",
      "type": "task",
      "epic": "UI Components",
      "title": "Reduce SmartProjectBase and ProjectTaskList complexity",
      "description": "SmartProjectBase.vue and ProjectTaskList.vue contain arrow functions with high cyclomatic complexity, indicating logic that should be decomposed for clarity and maintainability.",
      "acceptance_criteria": [
        "Extract complex branches into helper functions or composables",
        "Keep component behavior unchanged",
        "Resolve ESLint complexity warnings in both files",
        "Add/update documentation for any new helpers"
      ],
      "passes": false
    },
    {
      "id": "TASK-260105-024",
      "type": "task",
      "epic": "Models",
      "title": "Simplify Task and RecurrenceRule constructors",
      "description": "Task and RecurrenceRule constructors exceed ESLint complexity limits, suggesting that validation/normalization logic should be extracted for clarity.",
      "acceptance_criteria": [
        "Extract validation/normalization logic into helper functions",
        "Keep model behavior and data mappings unchanged",
        "Resolve constructor complexity warnings",
        "Document non-obvious validation rules"
      ],
      "passes": false
    },
    {
      "id": "TASK-260105-025",
      "type": "task",
      "epic": "Projects",
      "title": "Reduce deleteProject complexity in project service",
      "description": "deleteProject in app/src/services/project.js exceeds ESLint complexity limits, indicating logic that should be decomposed for clarity.",
      "acceptance_criteria": [
        "Extract conditional branches into small helper functions",
        "Keep delete behavior and side effects unchanged",
        "Resolve ESLint complexity warning in deleteProject",
        "Add/update documentation for the new helpers"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-026",
      "type": "task",
      "epic": "Database",
      "title": "Implement atomic transactions for project deletion",
      "description": "Project deletion lacks atomic transactions. Cascading deletes should use better-sqlite3 transaction blocks to ensure data integrity across related tables (tasks, notifications, recurrence rules).",
      "acceptance_criteria": [
        "Audit all project deletion paths in project service",
        "Wrap cascading delete operations in transaction blocks",
        "Test rollback behavior on deletion failures",
        "Ensure ON DELETE CASCADE constraints are properly utilized",
        "Document transaction pattern for other multi-table operations"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-027",
      "type": "task",
      "epic": "Database",
      "title": "Remove redundant manual deletion loops",
      "description": "Manual deletion loops exist despite ON DELETE CASCADE constraints in the database schema. These redundant operations increase code complexity and maintenance burden.",
      "acceptance_criteria": [
        "Audit all deletion paths for CASCADE-redundant manual deletes",
        "Remove manual deletion loops where CASCADE handles cleanup",
        "Verify schema has proper CASCADE constraints defined",
        "Add tests to CASCADE cleanup after removal of manual loops",
        "Document CASCADE pattern for future developers"
      ],
      "passes": false
    },
    {
      "id": "BUG-260106-029",
      "type": "bug",
      "epic": "Architecture",
      "title": "Resolve circular dependency between project and task services",
      "description": "There is a circular dependency risk between project.js and task.js services that could cause runtime errors or initialization issues.",
      "acceptance_criteria": [
        "Analyze and document the dependency chain between project and task services",
        "Refactor to eliminate circular dependencies",
        "Consider introducing a shared interface or event-driven pattern",
        "Add tests to prevent regression of circular dependencies",
        "Document proper pattern for cross-service operations"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-030",
      "type": "task",
      "epic": "UI Components",
      "title": "Separate presentation logic from business logic in components",
      "description": "Vue components contain mixed presentation and business logic. Business logic should be moved to models or composables for better testability and reusability.",
      "acceptance_criteria": [
        "Audit components for business logic that should be extracted",
        "Move data transformation logic to models",
        "Move reusable behavior to composables",
        "Keep only presentation logic in components",
        "Add tests for extracted business logic",
        "Document separation pattern in AGENTS.md"
      ],
      "passes": false
    }
  ]
}
