{
  "issues": [
    {
      "id": "STORY-250627-003",
      "type": "story",
      "epic": "Notifications",
      "title": "Detect system notification permissions status",
      "description": "Users need to enable system notifications manually in OS settings (e.g., macOS System Settings). The app should detect if notifications are enabled and provide in-app guidance to users when notifications are disabled.",
      "acceptance_criteria": [
        "Implement API to check system notification permission status",
        "Display user-friendly message in settings when notifications are disabled",
        "Provide direct link/button to open system notification settings",
        "Support macOS, Windows, and Linux platforms",
        "Add documentation for notification permission requirements"
      ],
      "passes": false
    },
    {
      "id": "STORY-250627-004",
      "type": "story",
      "epic": "Task Management",
      "title": "Implement task dependency selection UI",
      "description": "When creating or editing a task, users should be able to select dependencies from a dropdown with checkboxes. Selected dependencies become prerequisites that must be completed before the task can be started.",
      "acceptance_criteria": [
        "Add dependency selector component to task creation/edit form",
        "Display available tasks as checkboxes in searchable dropdown",
        "Show dependency relationships visually (e.g., task ordering indicators)",
        "Prevent circular dependencies in validation logic",
        "Auto-order tasks based on dependency completion status",
        "Update task list to show dependency relationships"
      ],
      "passes": false
    },
    {
      "id": "TASK-250627-011",
      "type": "task",
      "epic": "Architecture",
      "title": "Separate main process and renderer process concerns",
      "description": "The main process (app/electron.js) and IPC handlers import modules under app/src/services/*, blurring the boundary between main and renderer concerns. This complicates bundling/testing, especially where renderer-only utilities (e.g., window.logger) are referenced.",
      "acceptance_criteria": [
        "Audit all imports from app/src/services/* in main process files",
        "Move shared business logic to a location accessible by both processes",
        "Create main-specific service layer for IPC handlers",
        "Ensure renderer-only utilities are not referenced in main process",
        "Add tests for main process service layer",
        "Update AGENTS.md with clear separation guidance"
      ],
      "passes": true,
      "breakdown": [
        "Inventory main-process imports from app/src and document usage",
        "Define and document process boundaries and shared layer rules",
        "Extract shared models/utils into app/shared and update imports",
        "Move DB-backed services to app/electron-main/services; renderer uses IPC only",
        "Add tests for main service layer and update AGENTS.md"
      ],
      "notes": "Sequence: establish shared layer before functionHandlers and IPC refactors. Recommended to do first. COMPLETED: Main process files now import only from electron-main/* and shared/*; shared layer established with models and utils; renderer uses IPC only.",
      "recommended_sequence": 1
    },
    {
      "id": "TASK-250627-015",
      "type": "task",
      "epic": "Architecture",
      "title": "Refactor monolithic functionHandlers.js module",
      "description": "app/electron-main/functionHandlers.js is a monolith with multiple responsibilities (validation/parsing/filtering/formatting/tool dispatch). This will become harder to safely extend as more AI functions are added.",
      "acceptance_criteria": [
        "Analyze current responsibilities in functionHandlers.js",
        "Separate validation logic into dedicated module",
        "Separate parsing logic into dedicated module",
        "Separate filtering/formatting logic into utilities",
        "Keep only tool dispatch orchestration in functionHandlers",
        "Add tests for each extracted module",
        "Update AGENTS.md with new structure"
      ],
      "passes": true,
      "breakdown": [
        "Extract argument parsing and validation into dedicated modules",
        "Extract response formatting utilities (tasks/recurrence/notifications)",
        "Reduce functionHandlers to orchestration and dispatch only",
        "Add unit tests for each extracted module",
        "Update AGENTS.md with the new module structure"
      ],
      "notes": "Do after TASK-250627-011. COMPLETED: Refactored functionHandlers.js into modular ai-function-handlers/ structure with utils (argumentParsers, dateTimeParsers, projectResolvers, responseFormatters) and domain-specific handlers (taskHandlers, projectHandlers, notificationHandlers, recurrenceHandlers). functionHandlers.js is now a 10-line backward compatibility shim. Added 62 unit tests for all utility modules. All 431 tests pass. AGENTS.md already updated to reference new structure."
    },
    {
      "id": "STORY-250627-019",
      "type": "story",
      "epic": "Testing",
      "title": "Implement end-to-end tests for IPC communication boundaries",
      "description": "No end-to-end tests across preload <-> IPC <-> main <-> renderer boundaries. This critical communication path lacks integration testing, increasing risk of regressions in inter-process communication.",
      "acceptance_criteria": [
        "Research E2E testing approach for Electron (e.g., Spectron, Playwright)",
        "Create test infrastructure for spawning Electron app in test environment",
        "Write tests for preload script API exposure",
        "Write tests for IPC request/response flow (renderer -> main -> renderer)",
        "Write tests for IPC event flow (main -> renderer)",
        "Test error handling across process boundaries",
        "Add E2E tests to CI pipeline"
      ],
      "passes": false,
      "notes": "Automated E2E frameworks (e.g., Playwright/Spectron) are deprioritized; use manual smoke checks until revisited.",
      "deprioritized": true
    },
    {
      "id": "TASK-260105-021",
      "type": "task",
      "epic": "IPC Architecture",
      "title": "Refactor oversized IPC handler setup to reduce function length",
      "description": "setupIpcHandlers in app/electron-main/ipcHandlers.js exceeds the max-lines-per-function threshold, making the file harder to maintain and review.",
      "acceptance_criteria": [
        "Split setupIpcHandlers into smaller, focused helpers",
        "Preserve existing IPC behavior and handler registrations",
        "Keep file-level documentation up to date after refactor",
        "Resolve the max-lines-per-function lint warning"
      ],
      "passes": true,
      "breakdown": [
        "Create domain-specific IPC registration modules (projects, tasks, notifications, ai)",
        "Wire setupIpcHandlers to call the new registrars",
        "Preserve handler behavior and event emissions",
        "Update file-level documentation to reflect new structure",
        "Resolve max-lines-per-function lint warning"
      ],
      "notes": "Do after TASK-250627-011. COMPLETED: Split setupIpcHandlers (368 lines) into domain-specific modules (ipc/projectIpc.js, ipc/taskCrudIpc.js, ipc/taskSchedulingIpc.js, ipc/notificationIpc.js, ipc/recurrenceIpc.js, ipc/preferencesIpc.js, ipc/aiIpc.js). Main ipcHandlers.js now 48 lines. All 369 tests pass."
    },
    {
      "id": "TASK-260105-022",
      "type": "task",
      "epic": "UI Components",
      "title": "Reduce SmartProjectBase and ProjectTaskList complexity",
      "description": "SmartProjectBase.vue and ProjectTaskList.vue contain arrow functions with high cyclomatic complexity, indicating logic that should be decomposed for clarity and maintainability.",
      "acceptance_criteria": [
        "Extract complex branches into helper functions or composables",
        "Keep component behavior unchanged",
        "Resolve ESLint complexity warnings in both files",
        "Add/update documentation for any new helpers"
      ],
      "passes": true,
      "notes": "COMPLETED: Created app/src/components/smart/useTaskSorting.js composable with compareTasks() and compareOverdueTasks() functions. Replaced 52-line inline sort functions in SmartProjectBase.vue and ProjectTaskList.vue with composable calls. Complexity reduced from 27 to ~5 per function. All 431 tests pass."
    },
    {
      "id": "TASK-260105-024",
      "type": "task",
      "epic": "Models",
      "title": "Reduce Task and RecurrenceRule model complexity",
      "description": "Task.validate() (complexity 31 at line 119), Task constructor (complexity 16 at line 44), and RecurrenceRule constructor (complexity 12 at line 20) exceed ESLint limits (max 10). The Task.validate() complexity increased significantly after TASK-250627-009 added comprehensive validation logic. Extract validation logic into helper functions or a dedicated validation schema module.",
      "acceptance_criteria": [
        "Reduce Task.validate() complexity from 31 to \u226410 (app/shared/models/Task.js:119)",
        "Reduce Task constructor complexity from 16 to \u226410 (app/shared/models/Task.js:44)",
        "Reduce RecurrenceRule constructor complexity from 12 to \u226410 (app/shared/models/RecurrenceRule.js:20)",
        "Extract validation logic into helper functions or app/shared/models/validators/ module",
        "Keep all validation behavior and test coverage unchanged (all 369 tests must pass)",
        "Update AGENTS.md with validation pattern if new module structure is created"
      ],
      "files": [
        "app/shared/models/Task.js",
        "app/shared/models/RecurrenceRule.js"
      ],
      "passes": false
    },
    {
      "id": "TASK-260105-025",
      "type": "task",
      "epic": "Projects",
      "title": "Reduce deleteProject complexity in project service",
      "description": "deleteProject in app/electron-main/services/project.js exceeds ESLint complexity limits, indicating logic that should be decomposed for clarity.",
      "acceptance_criteria": [
        "Extract conditional branches into small helper functions",
        "Keep delete behavior and side effects unchanged",
        "Resolve ESLint complexity warning in deleteProject",
        "Add/update documentation for the new helpers"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-026",
      "type": "task",
      "epic": "Database",
      "title": "Implement atomic transactions for project deletion",
      "description": "Project deletion lacks atomic transactions. Cascading deletes should use better-sqlite3 transaction blocks to ensure data integrity across related tables (tasks, notifications, recurrence rules).",
      "acceptance_criteria": [
        "Audit all project deletion paths in project service",
        "Wrap cascading delete operations in transaction blocks",
        "Test rollback behavior on deletion failures",
        "Ensure ON DELETE CASCADE constraints are properly utilized",
        "Document transaction pattern for other multi-table operations"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-027",
      "type": "task",
      "epic": "Database",
      "title": "Remove redundant manual deletion loops",
      "description": "Manual deletion loops exist despite ON DELETE CASCADE constraints in the database schema. These redundant operations increase code complexity and maintenance burden.",
      "acceptance_criteria": [
        "Audit all deletion paths for CASCADE-redundant manual deletes",
        "Remove manual deletion loops where CASCADE handles cleanup",
        "Verify schema has proper CASCADE constraints defined",
        "Add tests to CASCADE cleanup after removal of manual loops",
        "Document CASCADE pattern for future developers"
      ],
      "passes": false
    },
    {
      "id": "BUG-260106-029",
      "type": "bug",
      "epic": "Architecture",
      "title": "Resolve circular dependency between project and task services",
      "description": "There is a circular dependency risk between project.js and task.js services that could cause runtime errors or initialization issues.",
      "acceptance_criteria": [
        "Analyze and document the dependency chain between project and task services",
        "Refactor to eliminate circular dependencies",
        "Consider introducing a shared interface or event-driven pattern",
        "Add tests to prevent regression of circular dependencies",
        "Document proper pattern for cross-service operations"
      ],
      "passes": false
    },
    {
      "id": "TASK-260106-030",
      "type": "task",
      "epic": "UI Components",
      "title": "Separate presentation logic from business logic in components",
      "description": "Vue components contain mixed presentation and business logic. Business logic should be moved to models or composables for better testability and reusability.",
      "acceptance_criteria": [
        "Audit components for business logic that should be extracted",
        "Move data transformation logic to models",
        "Move reusable behavior to composables",
        "Keep only presentation logic in components",
        "Add tests for extracted business logic",
        "Document separation pattern in AGENTS.md"
      ],
      "passes": false
    }
  ]
}
